# SPDX-License-Identifier: GPL-2.0
# Copyright (C) 2023 Analog Devices Inc.
%YAML 1.2
---
$id: http://devicetree.org/schemas/media/i2c/maxim-deserializer.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Maxim GMSL2 Deserializer

maintainers:
  - Cosmin Tanislav <cosmin.tanislav@analog.com>

allOf:
  - $ref: /schemas/pinctrl/i2c/i2c-atr.yaml#

unevaluatedProperties: false

required:
  - '#address-cells':
  - '#size-cells'
  - reg
  - i2c-atr
  - i2c-alias-pool

properties:
  '#address-cells':
    const: 1

  '#size-cells':
    const: 0

  reg:
    description: I2C device address
    maxItems: 1

  i2c-atr:
    type: object
    additionalProperties: false

    properties:
      '#address-cells':
        const: 1

      '#size-cells':
        const: 0

      maxim,pipe-stream-autoselect:
        type: boolean
        description: |
          Automatically select active streams for each pipe.
          If not specified, each pipe will receive a default stream id
          which can be overriden if needed.
          If specified, each pipe will receive data from all stream ids
          on its link, and the stream id cannot be overriden.
          Some chips might not support using this.

    patternProperties:
      '^i2c@[0-9a-f]+$':
        unevaluatedProperties: false

        allOf:
          - $ref: /schemas/i2c/i2c-controller.yaml

patternProperties:
  '^phy@[0-9a-f]+$':
    type: object
    additionalProperties: false
    description: |
      A PHY receives data from multiple pipes.

    properties:
      maxim,alt-mem-map8:
        type: boolean
        description: Alternative memory mapping for 8bit types.

      maxim,alt-mem-map10:
        type: boolean
        description: Alternative memory mapping for 8bit types.

      maxim,alt-mem-map12:
        type: boolean
        description: Alternative memory mapping for 10bit types.

  '^pipe@[0-9a-f]+$':
    type: object
    additionalProperties: false
    description: |
      A pipe can carry multiple video streams with each stream having
      different virtual channels and data types.

      A pipe operates in one of the following modes:
       - Mode 1: Streams with the same bpp of up to 24 bpp.
       - Mode 2: Streams with 16, 14, 12, 10, 8 bpp, with streams less than
                 16 bpp being zero-padded.
       - Mode 3: Streams with two different bpp rates, one being double
                 the other, with the highest possible bpp being 24.
      Only modes 1 and 3 carry data at full bandwidth.

      Each pipe receives data from one link.

      Each pipe outputs data to a PHY, and multiple pipes can output data
      to the same PHY.

    properties:
      reg:
        description: The pipe id.
        maxItems: 1
